<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ã‚¯ãƒ©ãƒ•ãƒˆç´ æè¨ˆç®—</title>
  <style>
    :root{
      --bg:#0b0f14;
      --card:#121826;
      --card2:#0f1521;
      --text:#e7eefc;
      --muted:#9fb0d0;
      --line:rgba(255,255,255,.10);
      --accent:#6ea8fe;
      --good:#37d67a;
      --warn:#ffcc66;
      --chip:rgba(110,168,254,.14);
      --shadow: 0 12px 40px rgba(0,0,0,.35);
      --radius:16px;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif;
      background: radial-gradient(1200px 700px at 20% -10%, rgba(110,168,254,.18), transparent 60%),
                  radial-gradient(900px 600px at 110% 20%, rgba(55,214,122,.10), transparent 55%),
                  var(--bg);
      color:var(--text);
    }
    header{
      padding:20px 20px 10px;
      border-bottom:1px solid var(--line);
      position:sticky; top:0; background:rgba(11,15,20,.86); backdrop-filter: blur(10px);
      z-index:10;
    }
    h1{margin:0 0 6px; font-size:20px;}
    .sub{color:var(--muted); font-size:12px; margin:0;}

    .wrap{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:16px;
      padding:16px;
      max-width:1200px;
      margin:0 auto;
    }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.03), transparent 60%), var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card h2{
      margin:0;
      padding:14px 14px 10px;
      font-size:14px;
      border-bottom:1px solid var(--line);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .card .content{padding:14px;}

    .toolbar{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      padding:14px;
      border-bottom:1px solid var(--line);
      background:linear-gradient(180deg, rgba(255,255,255,.02), transparent 70%), var(--card2);
    }
    .seg{
      display:flex;
      background:rgba(255,255,255,.04);
      border:1px solid var(--line);
      border-radius:999px;
      padding:4px;
      gap:4px;
      overflow:auto;
    }
    .seg button{
      border:0;
      background:transparent;
      color:var(--muted);
      padding:8px 12px;
      border-radius:999px;
      cursor:pointer;
      white-space:nowrap;
      font-size:12px;
    }
    .seg button.active{
      background:rgba(110,168,254,.18);
      color:var(--text);
      outline:1px solid rgba(110,168,254,.35);
    }

    .search{
      flex:1;
      min-width:180px;
      display:flex;
      gap:8px;
      align-items:center;
    }
    .search input{
      width:100%;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(0,0,0,.25);
      color:var(--text);
      outline:none;
    }
    .chip{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      color:var(--muted);
      font-size:12px;
      user-select:none;
    }
    .chip input{transform: translateY(1px);}

    .list{
      display:flex;
      flex-direction:column;
      gap:8px;
    }

    .row{
      border:1px solid var(--line);
      border-radius:14px;
      padding:10px 10px;
      background:rgba(255,255,255,.02);
      display:grid;
      grid-template-columns: 1fr 140px;
      gap:10px;
      align-items:center;
      transition:.15s ease;
    }
    .row:hover{transform: translateY(-1px); background:rgba(255,255,255,.03);}
    .row.entered{
      background:rgba(55,214,122,.10);
      border-color: rgba(55,214,122,.35);
    }
    .row .name{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:0;
    }

    .star{
      width:34px;height:34px;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      cursor:pointer;
      display:flex;align-items:center;justify-content:center;
      color:var(--muted);
      flex:0 0 auto;
    }
    .star.on{
      color: var(--warn);
      background:rgba(255,204,102,.10);
      border-color: rgba(255,204,102,.30);
    }

    .icon{
      width:56px;
      height:56px;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(0,0,0,.20);
      object-fit:contain;
      padding:6px;
      flex:0 0 auto;
    }

    .titleWrap{min-width:0;}
    .title{
      font-weight:700;
      font-size:13px;
      line-height:1.2;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .meta{
      margin-top:4px;
      color:var(--muted);
      font-size:11px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:3px 8px;
      border-radius:999px;
      background:var(--chip);
      border:1px solid rgba(110,168,254,.25);
      color:var(--text);
      font-size:11px;
    }

    .row input{
      width:100%;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(0,0,0,.25);
      color:var(--text);
      outline:none;
      font-size:14px;
      text-align:right;
    }

    .secTitle{
      margin:0 0 10px;
      font-size:12px;
      color:var(--muted);
      letter-spacing:.02em;
    }
    .kv{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:8px 0;
      border-bottom:1px dashed rgba(255,255,255,.12);
      gap:10px;
      font-size:13px;
    }
    .kv:last-child{border-bottom:0;}
    .yen{color:var(--warn); font-weight:800;}
    .muted{color:var(--muted); font-size:12px;}

    .box{
      border:1px solid var(--line);
      border-radius:14px;
      padding:10px;
      background:rgba(255,255,255,.02);
      margin-top:12px;
    }
    details{
      border:1px solid var(--line);
      border-radius:14px;
      background:rgba(255,255,255,.02);
      padding:10px;
      margin-top:10px;
    }
    summary{
      cursor:pointer;
      font-weight:700;
      font-size:13px;
      color:var(--text);
      list-style:none;
    }
    summary::-webkit-details-marker{display:none;}
    .opt{
      margin-top:10px;
      padding:10px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.18);
    }
    .opt .muted{margin-top:4px;}
    .opt ul{margin:8px 0 0; padding-left:18px;}
    .hint{
      margin-top:10px;
      color:var(--muted);
      font-size:12px;
    }

    @media (max-width: 980px){
      .wrap{grid-template-columns:1fr; }
      .row{grid-template-columns: 1fr 120px;}
      .icon{width:36px;height:36px;padding:5px;}
    }
  
    /* ===== çŠ¯ç½ªåã®å‰ã«ã¤ã‘ã‚‹ã‚«ãƒ©ãƒ¼ä¸¸ï¼ˆâ—ï¼‰ ===== */
    .crime-dot{
      font-size: 14px;
      margin-right: 6px;
      line-height: 1;
    }

    .crime-dot.small{ color:#3b82f6; } /* é’ */
    .crime-dot.mid{   color:#f59e0b; } /* ã‚ªãƒ¬ãƒ³ã‚¸ */
    .crime-dot.large{ color:#ef4444; } /* èµ¤ */
    .crime-dot.gig{   color:#a855f7; } /* ç´« */


    .tabs{
      display:flex;
      gap:10px;
      margin-top:14px;
      flex-wrap:wrap;
    }
    .tab{
      appearance:none;
      border:1px solid var(--line);
      background:rgba(0,0,0,.25);
      color:var(--text);
      padding:10px 14px;
      border-radius:14px;
      cursor:pointer;
      font-weight:700;
      letter-spacing:.02em;
      box-shadow: 0 10px 26px rgba(0,0,0,.25);
    }
    .tab:hover{ transform: translateY(-1px); }
    .tab.active{
      background: rgba(110,168,254,.18);
      border-color: rgba(110,168,254,.35);
    }
    .hidden{ display:none !important; }
    #crimeItems .item{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    #crimeItems .item .meta{ display:flex; flex-direction:column; gap:4px; }
    #crimeItems .item .qty{ font-weight:800; font-size:14px; }

    /* å¿…è¦æ¡ä»¶NOTEç”¨ */
    .note-box{
    border:1px solid rgba(255,204,102,.25);
    background:rgba(255,204,102,.05);
    }

    .note-text{
    font-size:13px;
    line-height:1.6;
    color:#ffcc66;
}


  </style>
</head>
<body>
<header>
  <h1>ã‚¯ãƒ©ãƒ•ãƒˆç´ æè¨ˆç®—</h1>
  <p class="sub">ã‚«ãƒ†ã‚´ãƒªâ†’ã‚¢ã‚¤ãƒ†ãƒ é¸æŠâ†’å›æ•°å…¥åŠ›ã€‚å¿…è¦ç´ æã¨æ–™é‡‘ã€ã‚¹ãƒ¼ãƒ‘ãƒ¼è³¼å…¥ã‚³ã‚¹ãƒˆã‚’ã¾ã¨ã‚ã¦å‡ºã—ã¾ã™ã€‚</p>
  <div class="tabs">
    <button id="tabCraft" class="tab active" type="button">ã‚¯ãƒ©ãƒ•ãƒˆè¨ˆç®—</button>
    <button id="tabCrime" class="tab" type="button">çŠ¯ç½ªã«å¿…è¦ãªé“å…·ä¸€è¦§</button>
  </div>
</header>

<div id="craftPage" class="wrap">
  <!-- LEFT -->
  <div class="card">
    <div class="toolbar">
      <div class="seg" id="categorySeg"></div>

      <div class="search">
        <input id="searchBox" type="text" placeholder="æ¤œç´¢ï¼ˆä¾‹ï¼šãƒãƒƒã‚° / å¼¾ / ãƒ‰ãƒªãƒ«ï¼‰" />
      </div>

      <label class="chip"><input id="showOnlyFav" type="checkbox" /> ãŠæ°—ã«å…¥ã‚Šã ã‘</label>
      <label class="chip"><input id="showOnlyEntered" type="checkbox" /> å…¥åŠ›ä¸­ã ã‘è¡¨ç¤º</label>
      <label class="chip"><input id="pinEntered" type="checkbox" checked /> å…¥åŠ›æ¸ˆã¿ã‚’ä¸Šã¸</label>
      <button id="resetBtn" class="chip" type="button">å…¥åŠ›ãƒªã‚»ãƒƒãƒˆ</button>

    </div>

    <div class="content">
      <div id="items" class="list"></div>
      <div class="hint">â€» æ•°å€¤ã¯ã€Œã‚¯ãƒ©ãƒ•ãƒˆå›æ•°ã€ã§ã™ï¼ˆå‡ºæ¥ä¸ŠãŒã‚Šæ•°ã¯ yield åæ˜ ï¼‰</div>
    </div>
  </div>

  <!-- RIGHT -->
  <div class="card">
    <h2>
      <span>çµæœ</span>
      <span class="muted" id="resultNote"></span>
    </h2>

    <div class="content">
      <div class="box">
        <div class="secTitle">æ–™é‡‘åˆè¨ˆï¼ˆã‚¯ãƒ©ãƒ•ãƒˆæ–™é‡‘ï¼‰</div>
        <div class="kv"><span>åˆè¨ˆ</span><b class="yen" id="totalYen">0å††</b></div>
        <div class="muted" id="yenBreakdown"></div>
      </div>

      <div class="box">
        <div class="secTitle">ã‚¹ãƒ¼ãƒ‘ãƒ¼è³¼å…¥åˆè¨ˆ</div>

        <div class="kv"><span>ææ–™ã‚’å…¨éƒ¨è²·ã†å ´åˆ</span><b class="yen" id="shopMatsTotal">0å††</b></div>
        <div class="muted" id="shopMatsBreakdown"></div>

        <div style="height:10px;"></div>

        <div class="kv"><span>å…¥åŠ›ã—ãŸå®Œæˆå“ã‚’è²·ã†å ´åˆ</span><b class="yen" id="shopItemsTotal">0å††</b></div>
        <div class="muted" id="shopItemsBreakdown"></div>
      </div>

      <div class="box">
        <div class="secTitle">å¿…è¦ç´ æï¼ˆåˆè¨ˆï¼‰</div>
        <div id="materials"></div>
      </div>

      <details id="altDetails">
        <summary>ä»£æ›¿ãƒ¬ã‚·ãƒ”ï¼ˆæ‰‹å‹•ã§é¸æŠã§ãã¾ã™ï¼‰</summary>
        <div id="altBreakdowns"></div>
      </details>
    </div>
  </div>
</div>



<!-- CRIME PAGE -->
<div id="crimePage" class="wrap hidden">
  <!-- LEFT -->
  <div class="card">
    <div class="toolbar">
      <div class="seg">
        <div class="title">çŠ¯ç½ªãƒ—ãƒªã‚»ãƒƒãƒˆ</div>
      </div>

      <div class="crimebar" style="display:flex; gap:8px; align-items:center; min-width:260px; flex:0 0 360px;">
      <div style="display:flex; align-items:center; gap:8px;">
      <span id="crimeDotPreview" class="crime-dot mid">â—</span>

      <select id="crimeSelect" aria-label="çŠ¯ç½ªãƒ—ãƒªã‚»ãƒƒãƒˆ"
        style="width:100%; padding:10px 12px; border-radius:12px; border:1px solid var(--line); background:rgba(0,0,0,.25); color:var(--text); outline:none; font-size:12px;">
      </select>
      <select id="crimeMethod" aria-label="æ–¹æ³•" class="hidden"
        style="width:100%; max-width:160px; padding:10px 12px; border-radius:12px; border:1px solid var(--line);
          background:rgba(0,0,0,.25); color:var(--text); outline:none; font-size:12px;">
      </select>

      
    </div>
        <input id="crimeTimes" class="chip" type="number" min="1" step="1" value="1" style="width:86px; text-align:center;" title="å›æ•°/äººæ•°" />
      </div>

      <label class="chip"><input id="crimeIncludeMaterials" type="checkbox" checked /> ç´ æã‚‚å«ã‚ã‚‹</label>
      <label class="chip"><input id="crimeSingleMode" type="checkbox" checked /> å˜ä½“ãƒ¢ãƒ¼ãƒ‰</label>
      <button id="addCrimeBtn" class="chip" type="button">ï¼ˆè¤‡æ•°ç”¨ï¼‰è¿½åŠ </button>
      <button id="clearCrimeBtn" class="chip" type="button">ã‚»ãƒƒãƒˆã‚¯ãƒªã‚¢</button>

      <div class="hint">â€» ã€Œå›æ•°ã€ã¯ <b>äººæ•°åˆ†ï¼ˆãƒãƒƒã‚°ãªã©ï¼‰</b> ã‚’å¢—ã‚„ã—ãŸã„æ™‚ã«ã‚‚ä½¿ãˆã¾ã™ã€‚</div>
    </div>

    <div class="content">
      <div id="crimeItems" class="list"></div>
      <div class="hint">â€» ã“ã“ã¯å¿…è¦ãªé“å…·/ç´ æã ã‘ã‚’ä¸€è¦§è¡¨ç¤ºã™ã‚‹å°‚ç”¨ãƒšãƒ¼ã‚¸ã§ã™ã€‚</div>
    </div>
  </div>

  <!-- RIGHT -->
  <div class="card">
    <h2><span>çŠ¯ç½ªã‚»ãƒƒãƒˆ</span><span class="muted">ï¼ˆé¸æŠä¸­ã®å†…å®¹ï¼‰</span></h2>
    <div class="content">
      <div class="box">
        <div class="secTitle">å¿…è¦é“å…·ï¼ˆåˆè¨ˆï¼‰</div>
        <div id="crimePlan" class="muted">ï¼ˆã¾ã è¿½åŠ ãŒã‚ã‚Šã¾ã›ã‚“ï¼‰</div>
      </div>

      <details open>
        <summary>ä½¿ã„æ–¹</summary>
        <div class="muted" style="margin-top:10px; line-height:1.8;">
          â‘  ä¸Šã§çŠ¯ç½ªã‚’é¸ã¶ â†’ â‘¡ å›æ•°ã‚’å…¥ã‚Œã‚‹ï¼ˆä¾‹ï¼šå›åè€…äººæ•°ï¼‰ â†’ â‘¢ å·¦ã«å¿…è¦ãªé“å…·/ç´ æãŒå‡ºã¾ã™ã€‚<br/>
          ã€Œç´ æã‚‚å«ã‚ã‚‹ã€ã‚’ONã«ã™ã‚‹ã¨ã€é“å…·ã®ç´ æã¾ã§è‡ªå‹•ã§å±•é–‹ã—ã¦è¡¨ç¤ºã—ã¾ã™ï¼ˆRECIPESãŒã‚ã‚‹ã‚‚ã®ã®ã¿ï¼‰ã€‚<br/>
          ã€Œå˜ä½“ãƒ¢ãƒ¼ãƒ‰ã€ONãªã‚‰ã€çŠ¯ç½ªã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã ã‘ã§å†…å®¹ãŒå…¥ã‚Œæ›¿ã‚ã‚Šã¾ã™ã€‚<br/>
          è¤‡æ•°çŠ¯ç½ªã‚’åˆç®—ã—ãŸã„æ™‚ã ã‘ã€Œï¼ˆè¤‡æ•°ç”¨ï¼‰è¿½åŠ ã€ã‚’ä½¿ã£ã¦ãã ã•ã„ã€‚
        </div>
      </details>
    </div>
  </div>
</div>

<script>
/* =======================
   ãƒ‡ãƒ¼ã‚¿
======================= */
const CATEGORIES = [
  "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°",
  "ã‚¬ãƒ³ã‚¹ãƒŸã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ™ãƒ³ãƒ",
  "åŒ–å­¦ä½œæ¥­å°",
  "è–¬ç‰©è£½é€ å°"
];

const RECIPES = {
  // é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°
  "çŠ¯ç½ªç”¨å°å‹C4çˆ†å¼¾": { "ã‚¢ãƒ«ãƒŸç²‰": 1 },
  "å°å‹ã‚µãƒ¼ãƒãƒ«ãƒ‰ãƒªãƒ«": { "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ãƒ‰ãƒªãƒ«ãƒ“ãƒƒãƒˆ": 2 },
  "çŠ¯ç½ªç”¨å°å‹ãƒ†ãƒ«ãƒŸãƒƒãƒˆçˆ†å¼¾": { "ã‚¢ãƒ«ãƒŸç²‰": 1 },
  "å°å‹ãƒãƒƒã‚°": { "å¸ƒ": 20, "å°å‹ãƒ­ãƒ¼ãƒ—": 3 },
  "è²´é‡‘å±": { }, // ALTã§å±•é–‹
  "å°å‹ãƒ‰ãƒªãƒ«": { "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ãƒ‰ãƒªãƒ«ãƒ“ãƒƒãƒˆ": 1 },
  "æ‰‹éŒ ã®éµ": { "é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 3 },
  "ãƒ“ã‚¸ãƒã‚¹ãƒãƒƒã‚°ç”¨ãƒ­ãƒƒã‚¯ãƒ”ãƒƒã‚«ãƒ¼": { "é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 3 },
  "çŠ¯ç½ªç”¨USBãƒ¡ãƒ¢ãƒª 1.0": { "é›»å­ã‚­ãƒƒãƒˆ": 1 },
  "ãƒ­ãƒƒã‚¯ãƒ”ãƒƒã‚¯": { "é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1 },
  "é›»å­ã‚­ãƒƒãƒˆ": { "è²´é‡‘å±": 1, "éŠ…ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1 }, // ALTã‚‚ã‚ã‚Š
  "çŠ¯ç½ªç”¨ãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰1": { "é›»å­ã‚­ãƒƒãƒˆ": 1 },
  "å°å‹ã‚°ãƒ©ã‚¤ãƒ³ãƒ€ãƒ¼": { "ãƒ¡ã‚¿ãƒ«ãƒ–ãƒ¬ãƒ¼ãƒ‰": 1 },

  "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ãƒ‰ãƒªãƒ«ãƒ“ãƒƒãƒˆ": { "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰": 40 },
  "çŠ¯ç½ªç”¨USBãƒ¡ãƒ¢ãƒª 2.0": { "é›»å­ã‚­ãƒƒãƒˆ": 2, "é‡‘å±æ¥åˆå‰¤": 5 },
  "çŠ¯ç½ªç”¨ãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰2": { "é›»å­ã‚­ãƒƒãƒˆ": 1, "é‡‘å±æ¥åˆå‰¤": 5 },
  "çŠ¯ç½ªç”¨ã®ãƒãƒ¼ãƒ«": { "é‹¼é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1, "é‡‘å±æ¥åˆå‰¤": 5 },
  "çŠ¯ç½ªç”¨ä¸­å‹C4çˆ†å¼¾": { "ã‚¢ãƒ«ãƒŸç²‰": 2, "é‡‘å±æ¥åˆå‰¤": 5 },
  "çŠ¯ç½ªç”¨ä¸­å‹ã‚«ãƒƒã‚¿ãƒ¼": { "é‹¼é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1, "é‡‘å±æ¥åˆå‰¤": 5 },
  "çŠ¯ç½ªç”¨ä¸­å‹ãƒ†ãƒ«ãƒŸãƒƒãƒˆçˆ†å¼¾": { "ã‚¢ãƒ«ãƒŸç²‰": 2, "é‡‘å±æ¥åˆå‰¤": 5 },
  "çŠ¯ç½ªç”¨ä¸­å‹ãƒ‰ãƒªãƒ«": { "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ãƒ‰ãƒªãƒ«ãƒ“ãƒƒãƒˆ": 2, "é‡‘å±æ¥åˆå‰¤": 5 },
  "çŠ¯ç½ªç”¨å¤§å‹C4çˆ†å¼¾": { "ã‚¢ãƒ«ãƒŸç²‰": 10, "ä¸‡èƒ½æ¥åˆå‰¤": 2 },
  "çŠ¯ç½ªç”¨å¤§å‹ãƒãƒƒã‚°": { "å¸ƒ": 20 },
  "çŠ¯ç½ªç”¨ä¸­å‹ãƒãƒƒã‚°": { "å¸ƒ": 1, "é‡‘å±æ¥åˆå‰¤": 5 },

  // ã‚¬ãƒ³ã‚¹ãƒŸã‚¹
  "ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒãƒ³": { "ãƒ¡ãƒ†ã‚ªãƒ©ã‚¤ãƒˆã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1, "éŠ…ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1, "é‹¼é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1 },
  "ãƒãƒ¼ã‚¿ãƒ–ãƒ«EMPãƒ‡ãƒã‚¤ã‚¹": { "éŠ…ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 2, "é‹¼é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1, "é›»å­ã‚­ãƒƒãƒˆ": 1 },
  "ã‚°ãƒ¬ãƒãƒ¼ãƒ‰": { "éŠ…ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1, "é‹¼é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1 },
  "ãƒ”ã‚¹ãƒˆãƒ«": { "ãƒ”ã‚¹ãƒˆãƒ«ãƒœãƒ‡ã‚£": 1, "é‰„ã®ãƒãƒ": 5 },
  "é ‘ä¸ˆãªé˜²å¼¾ãƒãƒ§ãƒƒã‚­": { "å¸ƒ": 30, "ã‚«ãƒ¼ãƒœãƒ³ãƒ•ã‚¡ã‚¤ãƒãƒ¼": 30, "è²´é‡‘å±": 5 },
  "Micro SMG": { "SMGãƒœãƒ‡ã‚£": 1, "é‰„ã®ãƒãƒ": 5, "é‰„ã®æ­¯è»Š": 1 },
  ".45 ACPå¼¾": { "é‹¼é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 6 },
  "9mmå¼¾": { "é‹¼é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 3 },
  "ã‚µãƒ—ãƒ¬ãƒƒã‚µãƒ¼": { "ã‚«ãƒ¼ãƒœãƒ³ãƒ•ã‚¡ã‚¤ãƒãƒ¼": 5, "ã‚°ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒãƒ¼": 10, "é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 10 },
  "ã‚¹ãƒ¢ãƒ¼ã‚¯ã‚°ãƒ¬ãƒãƒ¼ãƒ‰": { "ãƒ¡ãƒ†ã‚ªãƒ©ã‚¤ãƒˆã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1, "éŠ…ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 2, "é‹¼é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1 },
  "ã‚¿ã‚¯ãƒ†ã‚£ã‚«ãƒ«ã‚µãƒ—ãƒ¬ãƒƒã‚µãƒ¼": { "ã‚«ãƒ¼ãƒœãƒ³ãƒ•ã‚¡ã‚¤ãƒãƒ¼": 5, "ã‚°ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒãƒ¼": 10, "é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 10 },
  "ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ©ã‚¤ãƒˆ": { "ã‚°ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒãƒ¼": 10, "é›»å­ã‚­ãƒƒãƒˆ": 5 },

  // åŒ–å­¦ä½œæ¥­å°
  "ãƒãƒƒã‚¯ãƒ‘ãƒƒã‚¯Lv2": { "å¸ƒ": 5, "å°å‹ãƒãƒƒã‚°": 10 },
  "åŒ–å­¦è–¬å“ã‚¯ãƒ©ãƒ•ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«": { "ã‚¢ã‚µãƒ«ãƒˆãƒ©ã‚¤ãƒ•ãƒ«ãƒœãƒ‡ã‚£": 20, "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰": 50 },
  "æ²¹": { }, // ALT
  "ãƒ¡ã‚¿ãƒ«ãƒ–ãƒ¬ãƒ¼ãƒ‰": { "é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1, "é‹¼é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1 },
  "åŒ»ç™‚ã‚­ãƒƒãƒˆ": { "å¸ƒ": 1, "ãƒ©ã‚¤ãƒ ": 1, "é‹¼é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1 },
  "é‰„ã®æ­¯è»Š": { "é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 2, "é‹¼é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1 },
  "ãƒãƒƒã‚¯ãƒ‘ãƒƒã‚¯Lv1": { "å¸ƒ": 1, "å°å‹ãƒãƒƒã‚°": 1 },
  "ã‚¹ãƒ—ãƒ¬ãƒ¼ãƒªãƒ ãƒ¼ãƒãƒ¼": { "å¸ƒ": 2 },
  "ã‚¹ãƒ—ãƒ¬ãƒ¼": { "ã‚¨ãƒ¡ãƒ©ãƒ«ãƒ‰": 1, "ã‚µãƒ•ã‚¡ã‚¤ã‚¢": 1 },
  "è»Šä¸¡å¼•ãæ›ãˆã‚´ãƒ¼ãƒ«ãƒ‰ãƒã‚±ãƒƒãƒˆ": { "è»Šä¸¡ã‚¬ãƒãƒ£ã®ç ´ç‰‡": 30 },
  "ä¸‡èƒ½æ¥åˆå‰¤": { "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰": 100, "é‡‘å±æ¥åˆå‰¤": 5 },
  "ãƒ€ãƒƒãƒ•ãƒ«ãƒãƒƒã‚°": { "å¸ƒ": 10, "ã‚¨ãƒ¡ãƒ©ãƒ«ãƒ‰": 80, "å°å‹ãƒãƒƒã‚°": 30, "å°å‹ãƒ­ãƒ¼ãƒ—": 10 },
  "é›»å­æ©Ÿå™¨ã‚¯ãƒ©ãƒ•ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«": { "ã‚¢ã‚µãƒ«ãƒˆãƒ©ã‚¤ãƒ•ãƒ«ãƒœãƒ‡ã‚£": 20, "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰": 50 },
  "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰": { "æœªåŠ å·¥ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰": 5 }, // yield 5
  "é‡‘å±æ¥åˆå‰¤": { "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰": 30 },
  "åŒ…å¸¯": { "å¸ƒ": 1 },
  "SMGãƒœãƒ‡ã‚£": { }, // ALT
  "ãƒœã‚¤ã‚¹ãƒ†ãƒ¼ãƒ—": { "é›»å­ã‚­ãƒƒãƒˆ": 1 },
  "ãƒ”ã‚¹ãƒˆãƒ«ãƒœãƒ‡ã‚£": { "ã‚«ãƒ¼ãƒœãƒ³ãƒ•ã‚¡ã‚¤ãƒãƒ¼": 25 },
  "ã‚°ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒãƒ¼": { "ã‚¬ãƒ©ã‚¹": 1 },
  "æ­¦å™¨ã‚¯ãƒ©ãƒ•ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«": { "ã‚¢ã‚µãƒ«ãƒˆãƒœãƒ‡ã‚£": 20, "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰": 50 },
  "ã‚µãƒœãƒ†ãƒ³ã‚¯ãƒªãƒ¼ãƒ ": { "ã‚µãƒœãƒ†ãƒ³ã®æœå®Ÿ": 1 },
  "å¼¾è–¬ãƒãƒƒã‚°": { "å¸ƒ": 10, "å°å‹ãƒãƒƒã‚°": 10 },
  "é‰„ã®ãƒãƒ": { "é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1, "é‹¼é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 2 },
  "ãŠç€æ›¿ãˆãƒãƒƒã‚°": { "å¸ƒ": 20, "å°å‹ãƒãƒƒã‚°": 1 },

  // è–¬ç‰©è£½é€ å°
  "ã€éº»è–¬ã€‘ãƒ–ãƒ«ãƒ¼ã‚¢ã‚¦ãƒˆ": { "ãƒ–ãƒ«ãƒ¼ãƒ•ãƒ©ãƒ¯ãƒ¼": 1, "é‡‘ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1 },
  "ã€éº»è–¬ã€‘ãƒ¬ãƒƒãƒ‰ã‚¹ãƒšã‚¯ã‚¿ãƒ¼": { "ãƒ¬ãƒƒãƒ‰ãƒ•ãƒ©ãƒ¯ãƒ¼": 1, "éŠ…ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1 },
  "ã€éº»è–¬ã€‘ãƒ›ãƒ¯ã‚¤ãƒˆãƒãƒƒãƒ‰": { "ãƒ›ãƒ¯ã‚¤ãƒˆãƒ•ãƒ©ãƒ¯ãƒ¼": 1, "éŠ€ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1 },
};

const IMAGE_MAP = {
  "çŠ¯ç½ªç”¨å°å‹C4çˆ†å¼¾": "c4_small.png",
  "å°å‹ã‚µãƒ¼ãƒãƒ«ãƒ‰ãƒªãƒ«": "thermal_drill_small.png",
  "çŠ¯ç½ªç”¨å°å‹ãƒ†ãƒ«ãƒŸãƒƒãƒˆçˆ†å¼¾": "thermite_small.png",
  "å°å‹ãƒãƒƒã‚°": "small_bag.png",
  "å°å‹ãƒ‰ãƒªãƒ«": "drill_small.png",
  "æ‰‹éŒ ã®éµ": "handcuff_key.png",
  "ãƒ“ã‚¸ãƒã‚¹ãƒãƒƒã‚°ç”¨ãƒ­ãƒƒã‚¯ãƒ”ãƒƒã‚«ãƒ¼": "lockpick.png",
  "çŠ¯ç½ªç”¨USBãƒ¡ãƒ¢ãƒª 1.0": "crime_usb_1.png",
  "ãƒ­ãƒƒã‚¯ãƒ”ãƒƒã‚¯": "lockpick.png",
  "é›»å­ã‚­ãƒƒãƒˆ": "electronic_kit.png",
  "çŠ¯ç½ªç”¨ãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰1": "crime_laptop_g1.png",
  "å°å‹ã‚°ãƒ©ã‚¤ãƒ³ãƒ€ãƒ¼": "grinder_small.png",
  "è²´é‡‘å±": "Precious Metal.png",
  "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ãƒ‰ãƒªãƒ«ãƒ“ãƒƒãƒˆ": "diamond_drill_bit.png",
  "çŠ¯ç½ªç”¨USBãƒ¡ãƒ¢ãƒª 2.0": "crime_usb_memory_2_0.png",
  "çŠ¯ç½ªç”¨ãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰2": "crime_laptop_grade_2.png",
  "çŠ¯ç½ªç”¨ã®ãƒãƒ¼ãƒ«": "crime_crowbar.png",
  "çŠ¯ç½ªç”¨ä¸­å‹C4çˆ†å¼¾": "crime_c4_charge_medium.png",
  "çŠ¯ç½ªç”¨ä¸­å‹ã‚«ãƒƒã‚¿ãƒ¼": "crime_cutter_medium.png",
  "çŠ¯ç½ªç”¨ä¸­å‹ãƒ†ãƒ«ãƒŸãƒƒãƒˆçˆ†å¼¾": "crime_thermite_charge_medium.png",
  "çŠ¯ç½ªç”¨ä¸­å‹ãƒ‰ãƒªãƒ«": "crime_drill_medium.png",
  "çŠ¯ç½ªç”¨å¤§å‹C4çˆ†å¼¾": "crime_c4_charge_large.png",
  "çŠ¯ç½ªç”¨å¤§å‹ãƒãƒƒã‚°": "crime_bag_large.png",
  "çŠ¯ç½ªç”¨ä¸­å‹ãƒãƒƒã‚°": "crime_bag_medium.png",

  "ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒãƒ³": "flashbang.png",
  "ãƒãƒ¼ã‚¿ãƒ–ãƒ«EMPãƒ‡ãƒã‚¤ã‚¹": "emp_portable.png",
  "ã‚°ãƒ¬ãƒãƒ¼ãƒ‰": "grenade.png",
  "ãƒ”ã‚¹ãƒˆãƒ«": "pistol.png",
  "é ‘ä¸ˆãªé˜²å¼¾ãƒãƒ§ãƒƒã‚­": "heavy_armor.png",
  "Micro SMG": "micro_smg.png",
  ".45 ACPå¼¾": "ammo_45acp.png",
  "9mmå¼¾": "ammo_9mm.png",
  "ã‚µãƒ—ãƒ¬ãƒƒã‚µãƒ¼": "suppressor.png",
  "ã‚¹ãƒ¢ãƒ¼ã‚¯ã‚°ãƒ¬ãƒãƒ¼ãƒ‰": "smoke_grenade.png",
  "ã‚¿ã‚¯ãƒ†ã‚£ã‚«ãƒ«ã‚µãƒ—ãƒ¬ãƒƒã‚µãƒ¼": "suppressor.png",
  "ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ©ã‚¤ãƒˆ": "flashlight.png",

  "ãƒãƒƒã‚¯ãƒ‘ãƒƒã‚¯Lv2": "backpack_lv2.png",
  "åŒ–å­¦è–¬å“ã‚¯ãƒ©ãƒ•ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«": "chemical_crafting_table.png",
  "æ²¹": "oil.png",
  "ãƒ¡ã‚¿ãƒ«ãƒ–ãƒ¬ãƒ¼ãƒ‰": "metal_blade.png",
  "åŒ»ç™‚ã‚­ãƒƒãƒˆ": "medkit.png",
  "é‰„ã®æ­¯è»Š": "gear_iron.png",
  "ãƒãƒƒã‚¯ãƒ‘ãƒƒã‚¯Lv1": "backpack_lv1.png",
  "ã‚¹ãƒ—ãƒ¬ãƒ¼ãƒªãƒ ãƒ¼ãƒãƒ¼": "spray_remover.png",
  "ã‚¹ãƒ—ãƒ¬ãƒ¼": "spray.png",
  "è»Šä¸¡å¼•ãæ›ãˆã‚´ãƒ¼ãƒ«ãƒ‰ãƒã‚±ãƒƒãƒˆ": "gold_ticket.png",
  "ä¸‡èƒ½æ¥åˆå‰¤": "universal_adhesive.png",
  "ãƒ€ãƒƒãƒ•ãƒ«ãƒãƒƒã‚°": "duffle_bag.png",
  "é›»å­æ©Ÿå™¨ã‚¯ãƒ©ãƒ•ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«": "electronics_crafting_table.png",
  "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰": "diamond.png",
  "é‡‘å±æ¥åˆå‰¤": "metal_adhesive.png",
  "åŒ…å¸¯": "bandage.png",
  "SMGãƒœãƒ‡ã‚£": "smg_body.png",
  "ãƒœã‚¤ã‚¹ãƒ†ãƒ¼ãƒ—": "voice_tape.png",
  "ãƒ”ã‚¹ãƒˆãƒ«ãƒœãƒ‡ã‚£": "pistol_body.png",
  "ã‚°ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒãƒ¼": "glass_fiber.png",
  "æ­¦å™¨ã‚¯ãƒ©ãƒ•ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«": "weapon_crafting_table.png",
  "ã‚µãƒœãƒ†ãƒ³ã‚¯ãƒªãƒ¼ãƒ ": "cactus_cream.png",
  "å¼¾è–¬ãƒãƒƒã‚°": "ammo_bag.png",
  "é‰„ã®ãƒãƒ": "spring_iron.png",
  "ãŠç€æ›¿ãˆãƒãƒƒã‚°": "outfit_bag.png",

  "ã€éº»è–¬ã€‘ãƒ–ãƒ«ãƒ¼ã‚¢ã‚¦ãƒˆ": "drug_blueout.png",
  "ã€éº»è–¬ã€‘ãƒ¬ãƒƒãƒ‰ã‚¹ãƒšã‚¯ã‚¿ãƒ¼": "drug_redspecter.png",
  "ã€éº»è–¬ã€‘ãƒ›ãƒ¯ã‚¤ãƒˆãƒãƒƒãƒ‰": "drug_whitemud.png"
};

function getImagePath(itemName) {
  const file = IMAGE_MAP[itemName];
  if (!file) return null;
  return `images/${file}`;
}

const ALT_RECIPES = {
  "è²´é‡‘å±": [
    { name: "é‡‘ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆã§ä½œã‚‹", recipe: { "é‡‘ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 2 }, yield: 1, costYen: 0 },
    { name: "ãƒ¡ãƒ†ã‚ªãƒ©ã‚¤ãƒˆã‚¤ãƒ³ã‚´ãƒƒãƒˆã§ä½œã‚‹", recipe: { "ãƒ¡ãƒ†ã‚ªãƒ©ã‚¤ãƒˆã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1 }, yield: 1, costYen: 0 },
  ],
  "é›»å­ã‚­ãƒƒãƒˆ": [
    { name: "é€šå¸¸ï¼ˆ1å€‹ï¼‰", recipe: { "è²´é‡‘å±": 1, "éŠ…ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 1 }, yield: 1, costYen: 0 },
    { name: "é‡ç”£ï¼ˆ10å€‹ã§ãã‚‹ï¼‰", recipe: { "è²´é‡‘å±": 10, "éŠ…ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 10 }, yield: 10, costYen: 0 },
  ],
  "æ²¹": [
    { name: "ãƒˆã‚¦ãƒ¢ãƒ­ã‚³ã‚·è¢‹è©°ã‚ï¼ˆ5å€‹ã§ãã‚‹ï¼‰", recipe: { "ãƒˆã‚¦ãƒ¢ãƒ­ã‚³ã‚·ã®è¢‹è©°ã‚": 1 }, yield: 5, costYen: 0 },
    { name: "ãƒŸãƒ«ã‚¯ç®±è©°ã‚ï¼ˆ2å€‹ã§ãã‚‹ï¼‰", recipe: { "ãƒŸãƒ«ã‚¯ã®ç®±è©°ã‚": 1 }, yield: 2, costYen: 0 },
  ],
  "SMGãƒœãƒ‡ã‚£": [
    { name: "ãƒ”ã‚¹ãƒˆãƒ«ãƒœãƒ‡ã‚£3å€‹ã§ä½œã‚‹", recipe: { "ãƒ”ã‚¹ãƒˆãƒ«ãƒœãƒ‡ã‚£": 3 }, yield: 1, costYen: 100000 },
    { name: "ã‚«ãƒ¼ãƒœãƒ³ãƒ•ã‚¡ã‚¤ãƒãƒ¼50ã§ä½œã‚‹", recipe: { "ã‚«ãƒ¼ãƒœãƒ³ãƒ•ã‚¡ã‚¤ãƒãƒ¼": 50 }, yield: 1, costYen: 100000 },
  ],
};

const META = {
  /////////// é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°
  // çˆ†å¼¾ç³»
  "çŠ¯ç½ªç”¨å°å‹C4çˆ†å¼¾": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 1000, yield: 1 },
  "çŠ¯ç½ªç”¨å°å‹ãƒ†ãƒ«ãƒŸãƒƒãƒˆçˆ†å¼¾": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 2000, yield: 1 },
  "çŠ¯ç½ªç”¨ä¸­å‹C4çˆ†å¼¾": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 2500, yield: 1 },
  "çŠ¯ç½ªç”¨ä¸­å‹ãƒ†ãƒ«ãƒŸãƒƒãƒˆçˆ†å¼¾": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 3000, yield: 1 },
  "çŠ¯ç½ªç”¨å¤§å‹C4çˆ†å¼¾": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 5000, yield: 1 },

  // ãƒ‰ãƒªãƒ«ãƒ»åˆ‡æ–­ç³»
  "å°å‹ãƒ‰ãƒªãƒ«": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 0, yield: 1 },
  "å°å‹ã‚µãƒ¼ãƒãƒ«ãƒ‰ãƒªãƒ«": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 2000, yield: 1 },
  "çŠ¯ç½ªç”¨ä¸­å‹ãƒ‰ãƒªãƒ«": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 1200, yield: 1 },
  "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ãƒ‰ãƒªãƒ«ãƒ“ãƒƒãƒˆ": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 50000, yield: 1 },
  "å°å‹ã‚°ãƒ©ã‚¤ãƒ³ãƒ€ãƒ¼": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 500, yield: 1 },
  "çŠ¯ç½ªç”¨ä¸­å‹ã‚«ãƒƒã‚¿ãƒ¼": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 800, yield: 1 },

  // ãƒãƒƒã‚°ç³»
  "å°å‹ãƒãƒƒã‚°": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 100, yield: 1 },
  "çŠ¯ç½ªç”¨ä¸­å‹ãƒãƒƒã‚°": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 500, yield: 1 },
  "çŠ¯ç½ªç”¨å¤§å‹ãƒãƒƒã‚°": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 1000, yield: 1 },

  // é›»å­æ©Ÿå™¨ç³»
  "é›»å­ã‚­ãƒƒãƒˆ": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 0, yield: 1 },
  "çŠ¯ç½ªç”¨USBãƒ¡ãƒ¢ãƒª 1.0": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 500, yield: 1 },
  "çŠ¯ç½ªç”¨USBãƒ¡ãƒ¢ãƒª 2.0": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 600, yield: 1 },
  "çŠ¯ç½ªç”¨ãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰1": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 1500, yield: 1 },
  "çŠ¯ç½ªç”¨ãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰2": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 2000, yield: 1 },

  // ä¾µå…¥ãƒ»è§£é™¤ãƒ„ãƒ¼ãƒ«ç³»
  "ãƒ­ãƒƒã‚¯ãƒ”ãƒƒã‚¯": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 0, yield: 1 },
  "ãƒ“ã‚¸ãƒã‚¹ãƒãƒƒã‚°ç”¨ãƒ­ãƒƒã‚¯ãƒ”ãƒƒã‚«ãƒ¼": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 10000, yield: 1 },
  "çŠ¯ç½ªç”¨ã®ãƒãƒ¼ãƒ«": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 600, yield: 1 },
  "æ‰‹éŒ ã®éµ": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 10000, yield: 1 },

  // ç´ æãƒ»æˆ¦åˆ©å“ç³»
  "è²´é‡‘å±": { category: "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°", costYen: 0, yield: 1 },

  /////////// ã‚¬ãƒ³ã‚¹ãƒŸã‚¹
  // éŠƒæœ¬ä½“
  "ãƒ”ã‚¹ãƒˆãƒ«": { category: "ã‚¬ãƒ³ã‚¹ãƒŸã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ™ãƒ³ãƒ", costYen: 100000, yield: 1 },
  "Micro SMG": { category: "ã‚¬ãƒ³ã‚¹ãƒŸã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ™ãƒ³ãƒ", costYen: 200000, yield: 1 },

  // é˜²å…·
  "é ‘ä¸ˆãªé˜²å¼¾ãƒãƒ§ãƒƒã‚­": { category: "ã‚¬ãƒ³ã‚¹ãƒŸã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ™ãƒ³ãƒ", costYen: 50000, yield: 1 },

  // æŠ•æ“²æ­¦å™¨ãƒ»ç‰¹æ®Šãƒ‡ãƒã‚¤ã‚¹
  "ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒãƒ³": { category: "ã‚¬ãƒ³ã‚¹ãƒŸã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ™ãƒ³ãƒ", costYen: 0, yield: 2 },
  "ã‚¹ãƒ¢ãƒ¼ã‚¯ã‚°ãƒ¬ãƒãƒ¼ãƒ‰": { category: "ã‚¬ãƒ³ã‚¹ãƒŸã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ™ãƒ³ãƒ", costYen: 0, yield: 2 },
  "ã‚°ãƒ¬ãƒãƒ¼ãƒ‰": { category: "ã‚¬ãƒ³ã‚¹ãƒŸã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ™ãƒ³ãƒ", costYen: 0, yield: 2 },
  "ãƒãƒ¼ã‚¿ãƒ–ãƒ«EMPãƒ‡ãƒã‚¤ã‚¹": { category: "ã‚¬ãƒ³ã‚¹ãƒŸã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ™ãƒ³ãƒ", costYen: 0, yield: 2 },

  // å¼¾è–¬
  "9mmå¼¾": { category: "ã‚¬ãƒ³ã‚¹ãƒŸã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ™ãƒ³ãƒ", costYen: 0, yield: 100 },
  ".45 ACPå¼¾": { category: "ã‚¬ãƒ³ã‚¹ãƒŸã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ™ãƒ³ãƒ", costYen: 63000, yield: 100 },

  // ã‚¢ã‚¿ãƒƒãƒãƒ¡ãƒ³ãƒˆ
  "ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ©ã‚¤ãƒˆ": { category: "ã‚¬ãƒ³ã‚¹ãƒŸã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ™ãƒ³ãƒ", costYen: 5000, yield: 1 },
  "ã‚µãƒ—ãƒ¬ãƒƒã‚µãƒ¼": { category: "ã‚¬ãƒ³ã‚¹ãƒŸã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ™ãƒ³ãƒ", costYen: 5000, yield: 1 },
  "ã‚¿ã‚¯ãƒ†ã‚£ã‚«ãƒ«ã‚µãƒ—ãƒ¬ãƒƒã‚µãƒ¼": { category: "ã‚¬ãƒ³ã‚¹ãƒŸã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ™ãƒ³ãƒ", costYen: 5000, yield: 1 },

  /////////// åŒ–å­¦ä½œæ¥­å°
  // ä½œæ¥­å°ï¼ˆãƒ†ãƒ¼ãƒ–ãƒ«é¡ï¼‰
  "åŒ–å­¦è–¬å“ã‚¯ãƒ©ãƒ•ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 50000000, yield: 1 },
  "é›»å­æ©Ÿå™¨ã‚¯ãƒ©ãƒ•ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 50000000, yield: 1 },
  "æ­¦å™¨ã‚¯ãƒ©ãƒ•ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 50000000, yield: 1 },

  // ãƒãƒƒã‚°é¡
  "ãƒãƒƒã‚¯ãƒ‘ãƒƒã‚¯Lv1": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 0, yield: 1 },
  "ãƒãƒƒã‚¯ãƒ‘ãƒƒã‚¯Lv2": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 30000, yield: 1 },
  "ãƒ€ãƒƒãƒ•ãƒ«ãƒãƒƒã‚°": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 100000, yield: 1 },
  "å¼¾è–¬ãƒãƒƒã‚°": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 10000, yield: 1 },
  "ãŠç€æ›¿ãˆãƒãƒƒã‚°": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 0, yield: 1 },

  // åŒ»ç™‚ãƒ»å›å¾©ç³»
  "åŒ»ç™‚ã‚­ãƒƒãƒˆ": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 10000, yield: 1 },
  "åŒ…å¸¯": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 0, yield: 1 },
  "ã‚µãƒœãƒ†ãƒ³ã‚¯ãƒªãƒ¼ãƒ ": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 0, yield: 1 },

  // æ­¦å™¨ãƒ‘ãƒ¼ãƒ„
  "ãƒ”ã‚¹ãƒˆãƒ«ãƒœãƒ‡ã‚£": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 100000, yield: 1 },
  "SMGãƒœãƒ‡ã‚£": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 0, yield: 1 },

  // æ¥åˆå‰¤ãƒ»ã‚±ãƒŸã‚«ãƒ«é¡
  "é‡‘å±æ¥åˆå‰¤": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 5000, yield: 1 },
  "ä¸‡èƒ½æ¥åˆå‰¤": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 10000, yield: 1 },

  // ç´ æãƒ»éƒ¨å“
  "æ²¹": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 0, yield: 1 },
  "ã‚°ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒãƒ¼": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 0, yield: 1 },
  "ãƒ¡ã‚¿ãƒ«ãƒ–ãƒ¬ãƒ¼ãƒ‰": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 0, yield: 1 },
  "é‰„ã®æ­¯è»Š": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 0, yield: 1 },
  "é‰„ã®ãƒãƒ": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 0, yield: 1 },

  // ãã®ä»–
  "ã‚¹ãƒ—ãƒ¬ãƒ¼": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 0, yield: 1 },
  "ã‚¹ãƒ—ãƒ¬ãƒ¼ãƒªãƒ ãƒ¼ãƒãƒ¼": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 0, yield: 1 },
  "ãƒœã‚¤ã‚¹ãƒ†ãƒ¼ãƒ—": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 0, yield: 1 },
  "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 0, yield: 5 },
  "è»Šä¸¡å¼•ãæ›ãˆã‚´ãƒ¼ãƒ«ãƒ‰ãƒã‚±ãƒƒãƒˆ": { category: "åŒ–å­¦ä½œæ¥­å°", costYen: 0, yield: 1 },

  /////////// è–¬ç‰©è£½é€ å°
  "ã€éº»è–¬ã€‘ãƒ–ãƒ«ãƒ¼ã‚¢ã‚¦ãƒˆ": { category: "è–¬ç‰©è£½é€ å°", costYen: 0, yield: 1 },
  "ã€éº»è–¬ã€‘ãƒ¬ãƒƒãƒ‰ã‚¹ãƒšã‚¯ã‚¿ãƒ¼": { category: "è–¬ç‰©è£½é€ å°", costYen: 0, yield: 1 },
  "ã€éº»è–¬ã€‘ãƒ›ãƒ¯ã‚¤ãƒˆãƒãƒƒãƒ‰": { category: "è–¬ç‰©è£½é€ å°", costYen: 0, yield: 1 },
  "å®çŸ³åº—ã®åˆéµ": { category: "é“å…·", super: false },
  "204å·å®¤ã®éµ": { category: "é“å…·", super: false },
  "éŠƒå™¨ï¼ˆã‚·ãƒ§ãƒ¼ã‚±ãƒ¼ã‚¹ã‚’å£Šã›ã‚‹ã‚‚ã®ï¼‰": { category: "é“å…·", super: false },
};

// ã‚¹ãƒ¼ãƒ‘ãƒ¼è³¼å…¥ä¾¡æ ¼ï¼ˆ1å€‹ã‚ãŸã‚Šï¼‰
const SHOP_PRICE = {
  "ã‚¢ãƒ«ãƒŸç²‰": 10000,
  "ã‚¨ãƒ¡ãƒ©ãƒ«ãƒ‰": 10000,
  "ã‚µãƒ•ã‚¡ã‚¤ã‚¢": 10000,
  "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰": 10000,

  "ãƒ¡ãƒ†ã‚ªãƒ©ã‚¤ãƒˆã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 2000,
  "é‡‘ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 10000,
  "éŠ€ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 10000,

  "é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 2000,
  "éŠ…ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 10000,
  "é‹¼é‰„ã®ã‚¤ãƒ³ã‚´ãƒƒãƒˆ": 10000,

  "å°å‹ã‚°ãƒ©ã‚¤ãƒ³ãƒ€ãƒ¼": 200000,
  "å°å‹ã‚µãƒ¼ãƒãƒ«ãƒ‰ãƒªãƒ«": 200000,
  "å°å‹ãƒ‰ãƒªãƒ«": 200000,

  "å°å‹ãƒãƒƒã‚°": 200000,
  "å°å‹ãƒ­ãƒ¼ãƒ—": 200000,
};


/* =======================
   çŠ¯ç½ªãƒ—ãƒªã‚»ãƒƒãƒˆï¼ˆã“ã“ã‚’ç·¨é›†ã™ã‚Œã°å¢—ã‚„ã›ã¾ã™ï¼‰
   - key: çŠ¯ç½ªå
   - value: å¿…è¦ãªã€Œé“å…·ï¼ˆ=ã“ã®ãƒšãƒ¼ã‚¸ã®ã‚¢ã‚¤ãƒ†ãƒ åï¼‰ã€: å€‹æ•°
   â€» äººæ•°åˆ†ãŒå¿…è¦ãªã‚‚ã®ï¼ˆãƒãƒƒã‚°ç­‰ï¼‰ã¯ã€çŠ¯ç½ªãƒšãƒ¼ã‚¸ã®ã€Œå›æ•°ã€ã‚’äººæ•°ã«ã—ã¦èª¿æ•´ã—ã¦ãã ã•ã„ã€‚
======================= */
const CRIMES = {
  "å°å‹ - å®¶å¼·ç›—ï¼ˆç©ºãå·£ï¼‰": {
    "__NOTE__": "ğŸ›’ ãƒãƒ¼ã‚¿ãƒ–ãƒ«æº¶æ¥æ©Ÿï¼šå—æ³¨NPCã‹ã‚‰è³¼å…¥",
    "__NOTE2__": "ğŸ“ å—æ³¨å ´æ‰€ï¼š8012",
    "__NOTE3__": "ğŸ“ æ›é‡‘å ´æ‰€ï¼š8012"
  },
  "å°å‹ - ã‚³ãƒ³ãƒ“ãƒ‹å¼·ç›—": {
    "__NOTE__": "éŠƒå™¨ï¼šåº—å“¡NPCã‚’ãƒ€ã‚¦ãƒ³ã•ã›ã‚‰ã‚Œã‚‹ã€ãƒ¬ã‚¸ã‚’è§£æ”¾ã§ãã‚‹ã‚‚ã®ï¼ˆã‚³ãƒ³ãƒ“ãƒ‹è³¼å…¥ï¼‰"
  },
  "å°å‹ - ATMå¼·ç›—": {
    methods: {
      "ATMå¼•ãæŠœãå¼·ç›—": {
        "__NOTE__": "å…±é€šï¼šäººè³ªã‚’ç”¨æ„ã™ã‚‹ãªã‚‰éŠƒå™¨ãŒå¿…è¦ã€é€ƒèµ°è»Šä¸¡ã‚‚ã‚ã‚‹ã¨è‰¯ã„",
        "å°å‹ãƒ­ãƒ¼ãƒ—": 1,
        "è»Šä¸¡ï¼ˆé¦¬åŠ›ã®é«˜ã„è»Šã€‚SUVæ¨å¥¨ï¼‰": 1
      },
      "ãƒ‰ãƒªãƒ«å¼·ç›—": {
        "__NOTE__": "å…±é€šï¼šäººè³ªã‚’ç”¨æ„ã™ã‚‹ãªã‚‰éŠƒå™¨ãŒå¿…è¦ã€é€ƒèµ°è»Šä¸¡ã‚‚ã‚ã‚‹ã¨è‰¯ã„",
        "__NOTE2__": "å°å‹ãƒ‰ãƒªãƒ«ã¯ãƒŸãƒ‹ã‚²ãƒ¼ãƒ æˆåŠŸ/å¤±æ•—ã§æ¶ˆè²»",
        "å°å‹ãƒ‰ãƒªãƒ«": 1
      },
      "çˆ†å¼¾å¼·ç›—": {
        "__NOTE__": "å…±é€šï¼šäººè³ªã‚’ç”¨æ„ã™ã‚‹ãªã‚‰éŠƒå™¨ãŒå¿…è¦ã€é€ƒèµ°è»Šä¸¡ã‚‚ã‚ã‚‹ã¨è‰¯ã„",
        "çŠ¯ç½ªç”¨å°å‹C4çˆ†å¼¾": 1
      },
      "ãƒãƒƒã‚­ãƒ³ã‚°å¼·ç›—": {
        "__NOTE__": "å…±é€šï¼šäººè³ªã‚’ç”¨æ„ã™ã‚‹ãªã‚‰éŠƒå™¨ãŒå¿…è¦ã€é€ƒèµ°è»Šä¸¡ã‚‚ã‚ã‚‹ã¨è‰¯ã„",
        "__NOTE2__": "USBã¯ãƒŸãƒ‹ã‚²ãƒ¼ãƒ æˆåŠŸ/å¤±æ•—ã§æ¶ˆè²»",
        "çŠ¯ç½ªç”¨USBãƒ¡ãƒ¢ãƒª 1.0": 1
      }
    }
  },
  "å°å‹ - ãƒ•ãƒªãƒ¼ã‚µéŠ€è¡Œå¼·ç›—": {
    "çŠ¯ç½ªç”¨USBãƒ¡ãƒ¢ãƒª 1.0": 1,
    "çŠ¯ç½ªç”¨å°å‹C4çˆ†å¼¾": 2,
    "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰": 80
  },
  "å°å‹ - ä¸¡æ›¿æ‰€å¼·ç›—ï¼ˆLoudï¼‰": {
    "__NOTE__": "ğŸ”‘ ä¸¡æ›¿æ‰€ã®éµï¼šãƒŸãƒƒã‚·ãƒ§ãƒ³ä¸­ã«å…¥æ‰‹",
    "__NOTE2__": "ğŸ”« éŠƒå™¨ï¼šå¿…é ˆ",

    "çŠ¯ç½ªç”¨USBãƒ¡ãƒ¢ãƒª 1.0": 1,
    "çŠ¯ç½ªç”¨å°å‹ãƒãƒƒã‚°": 1,
    "å°å‹ã‚°ãƒ©ã‚¤ãƒ³ãƒ€ãƒ¼": 3
  },
  "å°å‹ - ä¸¡æ›¿æ‰€å¼·ç›—ï¼ˆSilentï¼‰": {
    "__NOTE__": "ğŸ”‘ ä¸¡æ›¿æ‰€ã®éµï¼šãƒŸãƒƒã‚·ãƒ§ãƒ³ä¸­ã«å…¥æ‰‹",
    "__NOTE2__": "ğŸ’¾ å¾©å·åŒ–ã•ã‚ŒãŸãƒ‡ãƒã‚¤ã‚¹ï¼šãƒŸãƒƒã‚·ãƒ§ãƒ³ä¸­ã«å…¥æ‰‹",
    "__NOTE3__": "ğŸ”« éŠƒå™¨ï¼šå¿…é ˆ",

    "çŠ¯ç½ªç”¨USBãƒ¡ãƒ¢ãƒª 1.0": 1,
    "çŠ¯ç½ªç”¨å°å‹ãƒãƒƒã‚°": 1,
    "å°å‹ã‚°ãƒ©ã‚¤ãƒ³ãƒ€ãƒ¼": 2
  },
  "å°å‹ - è¼¸é€è»Šä¸¡å¼·ç›—": {
    "å°å‹ãƒãƒƒã‚°": 1,
    "å°å‹ãƒ‰ãƒªãƒ«": 2,
    "çŠ¯ç½ªç”¨å°å‹C4çˆ†å¼¾": 1
  },
  "ä¸­å‹ - ãƒ‘ãƒ¬ãƒˆéŠ€è¡Œå¼·ç›—": {
    "çŠ¯ç½ªç”¨ãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³ ã‚°ãƒ¬ãƒ¼ãƒ‰2": 1,
    "çŠ¯ç½ªç”¨ä¸­å‹ãƒ‰ãƒªãƒ«": 3,
    "çŠ¯ç½ªç”¨USBãƒ¡ãƒ¢ãƒª 2.0": 3
  },
  "ä¸­å‹ - ã‚¯ãƒ«ãƒ¼ã‚¶ãƒ¼å¼·ç›—": {
    "çŠ¯ç½ªç”¨USBãƒ¡ãƒ¢ãƒª 2.0": 2,
    "çŠ¯ç½ªç”¨ä¸­å‹ãƒ‰ãƒªãƒ«": 4
  },
  "ä¸­å‹ - å®çŸ³åº—å¼·ç›—": {
    "å®çŸ³åº—ã®åˆéµ": 1,
    "çŠ¯ç½ªç”¨ã®ãƒãƒ¼ãƒ«": 1,
    "çŠ¯ç½ªç”¨ä¸­å‹ã‚«ãƒƒã‚¿ãƒ¼": 4,
    "éŠƒå™¨ï¼ˆã‚·ãƒ§ãƒ¼ã‚±ãƒ¼ã‚¹ã‚’å£Šã›ã‚‹ã‚‚ã®ï¼‰": 1
  },
  "ä¸­å‹ - ãƒœãƒ–ã‚­ãƒ£ãƒƒãƒˆå¼·ç›—ï¼ˆLoudï¼‰": {
    "çŠ¯ç½ªç”¨ãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³ ã‚°ãƒ¬ãƒ¼ãƒ‰2": 5,
    "çŠ¯ç½ªç”¨ã®ãƒãƒ¼ãƒ«": 1,
    "çŠ¯ç½ªç”¨ä¸­å‹C4çˆ†å¼¾": 3,
    "çŠ¯ç½ªç”¨USBãƒ¡ãƒ¢ãƒª 2.0": 3,
    "çŠ¯ç½ªç”¨ä¸­å‹ãƒãƒƒã‚¯": 1
  },
  "ä¸­å‹ - ãƒœãƒ–ã‚­ãƒ£ãƒƒãƒˆå¼·ç›—ï¼ˆSilentï¼‰": {
    "çŠ¯ç½ªç”¨ãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³ ã‚°ãƒ¬ãƒ¼ãƒ‰2": 5,
    "çŠ¯ç½ªç”¨ã®ãƒãƒ¼ãƒ«": 1,
    "çŠ¯ç½ªç”¨ä¸­å‹C4çˆ†å¼¾": 1,
    "çŠ¯ç½ªç”¨USBãƒ¡ãƒ¢ãƒª 2.0": 5,
    "Smoke Grenade": 1,
    "çŠ¯ç½ªç”¨ä¸­å‹ãƒãƒƒã‚¯": 1
  },
  "å¤§å‹ - ãƒ¦ãƒ‹ã‚ªãƒ³éŠ€è¡Œ": {
    "204å·å®¤ã®éµ": 1,
    "çŠ¯ç½ªç”¨å¤§å‹ãƒãƒƒã‚°": 1,
    "çŠ¯ç½ªç”¨å¤§å‹C4çˆ†å¼¾": 8
  }
};

function getCrimeReq(crimeName, methodName){
  const preset = CRIMES[crimeName] || {};
  if (preset.methods){
    const m = methodName || Object.keys(preset.methods)[0];
    return preset.methods[m] || {};
  }
  return preset;
}

function getCrimeDot(crimeName){
  if (crimeName.includes("å¤§å‹")) return '<span class="crime-dot large">â—</span>';
  if (crimeName.includes("ä¸­å‹")) return '<span class="crime-dot mid">â—</span>';
  if (crimeName.includes("å°å‹") || crimeName.includes("å°è¦æ¨¡")) return '<span class="crime-dot small">â—</span>';
  return '';
}

function getCrimeDisplayName(name){
  return name
    .replace(/^ä¸­å‹\s*-\s*/,"")
    .replace(/^å¤§å‹\s*-\s*/,"")
    .replace(/^å°å‹\s*-\s*/,"")
    .replace(/^å°è¦æ¨¡çŠ¯ç½ª\s*-\s*/,"");
}



/* =======================
   çŠ¶æ…‹
======================= */
let currentCategory = "é•æ³•ç‰©ã‚¯ãƒ©ãƒ•ãƒˆå°";
const counts = {};          // itemName -> craftTimes
const favorites = new Set();
const altChoice = {};

const selectedCrimes = []; // [{name, times}]
let crimeRequiredSet = new Set();
let currentPage = "craft";
       // altChoice["è²´é‡‘å±"]=0 ãªã©

/* =======================
   DOM
   â€» nullå¯¾ç­–ï¼šå¿…ãšå­˜åœ¨ãƒã‚§ãƒƒã‚¯ã—ã¦ã‹ã‚‰ä½¿ã†
======================= */
const $ = (id) => document.getElementById(id);

// â˜… crimeç³»ã¯ã¾ã¨ã‚ã‚‹
const crimeSelect = $("crimeSelect");
const crimeMethod = $("crimeMethod");
const crimeTimes  = $("crimeTimes");
const crimeDotPreview = $("crimeDotPreview");

const categorySeg = $("categorySeg");
const itemsEl = $("items");
const matsEl  = $("materials");
const altEl   = $("altBreakdowns");

const searchBox = $("searchBox");
const showOnlyFav = $("showOnlyFav");
const showOnlyEntered = $("showOnlyEntered");
const pinEntered = $("pinEntered");
const resetBtn = $("resetBtn");

const tabCraft = $("tabCraft");
const tabCrime = $("tabCrime");
const craftPage = $("craftPage");
const crimePage = $("crimePage");

function updateMethodSelect(){
  if(!crimeMethod || !crimeSelect) return;

  const crimeName = crimeSelect.value;
  const preset = CRIMES[crimeName] || {};

  // methodsãŒç„¡ã„çŠ¯ç½ªã¯ã€Œæ–¹æ³•ã€éè¡¨ç¤º
  if(!preset.methods){
    crimeMethod.classList.add("hidden");
    crimeMethod.innerHTML = "";
    return;
  }

  // methodsãŒã‚ã‚‹çŠ¯ç½ªã¯è¡¨ç¤ºã—ã¦ä¸­èº«ã‚’è©°ã‚ã‚‹
  crimeMethod.classList.remove("hidden");

  const methods = Object.keys(preset.methods);
  crimeMethod.innerHTML = methods.map(m => `<option value="${m}">${m}</option>`).join("");

  // æœªé¸æŠãªã‚‰å…ˆé ­ã‚’é¸ã¶
  if(!crimeMethod.value) crimeMethod.value = methods[0];
}

function updateCrimeDotPreview(){
  const name = crimeSelect.value;

  if(!name) return;

  if(name.includes("å¤§å‹")){
    crimeDotPreview.className = "crime-dot large";
  }
  else if(name.includes("ä¸­å‹")){
    crimeDotPreview.className = "crime-dot mid";
  }
  else if(name.includes("å°å‹") || name.includes("å°è¦æ¨¡")){
    crimeDotPreview.className = "crime-dot small";
  }
}

crimeSelect.addEventListener("change", () => {
  updateCrimeDotPreview();
  updateMethodSelect();

  // å˜ä½“ãƒ¢ãƒ¼ãƒ‰ãªã‚‰ã€ãã®å ´ã§åæ˜ ï¼ˆå¾Œã§methodå¯¾å¿œã™ã‚‹ãŸã‚ã®åœŸå°ï¼‰
  if (crimeSingleMode?.checked){
    selectedCrimes.length = 0;
    selectedCrimes.push({
      name: crimeSelect.value,
      method: crimeMethod?.classList.contains("hidden") ? null : crimeMethod.value,
      times: Math.max(1, Number(crimeTimes?.value || 1) || 1)
    });
  }

  renderCrimePlan();
  renderCrimeItems();
});


// åˆæœŸè¡¨ç¤ºï¼ˆé‡è¦ï¼‰
setTimeout(updateCrimeDotPreview, 0);
setTimeout(updateMethodSelect, 0);


const crimeIncludeMaterials = $("crimeIncludeMaterials");
const crimeSingleMode = $("crimeSingleMode");
const addCrimeBtn = $("addCrimeBtn");
const clearCrimeBtn = $("clearCrimeBtn");
const crimePlanEl = $("crimePlan");
const crimeItemsEl = $("crimeItems");



const totalYenEl = $("totalYen");
const yenBreakdownEl = $("yenBreakdown");
const resultNote = $("resultNote");

const shopMatsTotalEl = $("shopMatsTotal");
const shopMatsBreakdownEl = $("shopMatsBreakdown");
const shopItemsTotalEl = $("shopItemsTotal");
const shopItemsBreakdownEl = $("shopItemsBreakdown");

const altDetails = $("altDetails");

/* =======================
   ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
======================= */
function fmtYen(n){ return (n||0).toLocaleString("ja-JP"); }

function getYield(itemName){
  const y = META[itemName]?.yield;
  return Number.isFinite(y) && y > 0 ? y : 1;
}
function getCost(itemName){
  const c = META[itemName]?.costYen;
  return Number.isFinite(c) && c >= 0 ? c : 0;
}
function itemsByCategory(cat){
  return Object.keys(META).filter(k => META[k]?.category === cat);
}
function passesFilters(name){
  const q = (searchBox?.value || "").trim().toLowerCase();
  if (q && !name.toLowerCase().includes(q)) return false;
  if (showOnlyFav?.checked && !favorites.has(name)) return false;
  if (showOnlyEntered?.checked && (counts[name]||0) <= 0) return false;
  return true;
}

/* =======================
   è¨ˆç®—ï¼šç´ æåˆè¨ˆ + ã‚¯ãƒ©ãƒ•ãƒˆæ–™é‡‘åˆè¨ˆï¼ˆåŸºæœ¬ï¼‰
   - ALTå¯¾è±¡ã¯ã€Œå¿…è¦å€‹æ•°ã€ã¨ã—ã¦ totals ã«å…¥ã‚Œã‚‹ã ã‘
======================= */
function computeBaseTotalsAndCost(){
  const totals = {};
  let cost = 0;
  const costBreakdown = [];

  for (const [itemName, craftTimes] of Object.entries(counts)) {
    const t = craftTimes || 0;
    if (t <= 0) continue;

    const itemCost = getCost(itemName) * t;
    cost += itemCost;
    costBreakdown.push({ name:itemName, yen:itemCost });

    // ALTã‚¢ã‚¤ãƒ†ãƒ ã¯ã€Œæ¬²ã—ã„å€‹æ•°ã€ã¨ã—ã¦æ‰±ã†ï¼ˆææ–™å±•é–‹ã¯ALTå´ï¼‰
    if (ALT_RECIPES[itemName]) {
      totals[itemName] = (totals[itemName] || 0) + t;
      continue;
    }

    const recipe = RECIPES[itemName];
    if (!recipe) continue;

    for (const [mat, per] of Object.entries(recipe)) {
      totals[mat] = (totals[mat] || 0) + per * t;
    }
  }

  return { totals, cost, costBreakdown };
}

/* =======================
   ä»£æ›¿ãƒ¬ã‚·ãƒ”ã®å±•é–‹ï¼ˆæ‰‹å‹•é¸æŠï¼‰
   - totals[altItem] ã‚’å¿…è¦æ•°ã¨ã—ã¦ã€é¸æŠãƒ¬ã‚·ãƒ”ã®ææ–™ã‚’åŠ ç®—
======================= */
function buildAltBreakdowns(totals){
  const breakdowns = [];
  let chosenCostAdd = 0;
  const chosenCostBreakdown = [];
  const chosenMatsAdd = {};

  for (const [altItem, options] of Object.entries(ALT_RECIPES)) {
    const need = totals[altItem] || 0;
    if (need <= 0) continue;

    if (altChoice[altItem] == null) altChoice[altItem] = 0;

    const optionResults = options.map((opt, idx) => {
      const y = opt.yield || 1;
      const craftTimes = Math.ceil(need / y);

      const mats = {};
      for (const [mat, per] of Object.entries(opt.recipe)) {
        mats[mat] = per * craftTimes;
      }
      const costYen = (opt.costYen || 0) * craftTimes;

      return { idx, name: opt.name, need, yield:y, craftTimes, mats, costYen };
    });

    let chosenIndex = altChoice[altItem];
    if (!Number.isFinite(chosenIndex) || chosenIndex < 0 || chosenIndex >= optionResults.length) {
      chosenIndex = 0;
      altChoice[altItem] = 0;
    }
    const chosen = optionResults[chosenIndex];

    chosenCostAdd += chosen.costYen;
    chosenCostBreakdown.push({ name: `${altItem}ï¼ˆæ¡ç”¨ï¼š${chosen.name}ï¼‰`, yen: chosen.costYen });

    for (const [mat, v] of Object.entries(chosen.mats)) {
      chosenMatsAdd[mat] = (chosenMatsAdd[mat] || 0) + v;
    }

    breakdowns.push({ item: altItem, need, options: optionResults, chosenIndex });
  }

  return { breakdowns, chosenCostAdd, chosenCostBreakdown, chosenMatsAdd };
}

/* =======================
   ã‚¹ãƒ¼ãƒ‘ãƒ¼è³¼å…¥è¨ˆç®—
======================= */
// å¿…è¦ç´ æ totals ã‹ã‚‰ã€Œè²·ãˆã‚‹ç´ æã€ã ã‘åˆè¨ˆ
function calcShopCostFromTotals(totals){
  let sum = 0;
  const lines = [];
  const missing = [];

  for (const [name, qty] of Object.entries(totals)) {
    const q = qty || 0;
    if (q <= 0) continue;
    if (SHOP_PRICE[name] != null) {
      const yen = SHOP_PRICE[name] * q;
      sum += yen;
      lines.push({ name, yen });
    } else {
      missing.push(name);
    }
  }

  lines.sort((a,b)=> b.yen - a.yen);
  return { sum, lines, missing };
}

// å…¥åŠ›ã—ãŸã€Œå®Œæˆå“ãã®ã‚‚ã®ã€ã‚’ã‚¹ãƒ¼ãƒ‘ãƒ¼ã§è²·ãˆã‚‹ã‹åˆè¨ˆ
function calcShopCostFromEnteredItems(){
  let sum = 0;
  const lines = [];
  const missing = [];

  for (const [itemName, craftTimes] of Object.entries(counts)) {
    const t = craftTimes || 0;
    if (t <= 0) continue;

    // å®Œæˆå“è³¼å…¥ã¯ã€Œå‡ºæ¥ä¸ŠãŒã‚Šæ•°ã€ãƒ™ãƒ¼ã‚¹ã«ã—ãŸã„ãªã‚‰ produced ã‚’ä½¿ã†
    // ä»Šå›ã¯ã€Œå…¥åŠ›å›æ•°ï¼æ¬²ã—ã„å€‹æ•°ã€é‹ç”¨ã£ã½ã„ã®ã§ t ã‚’ãã®ã¾ã¾å€‹æ•°æ‰±ã„
    const qty = t;

    if (SHOP_PRICE[itemName] != null) {
      const yen = SHOP_PRICE[itemName] * qty;
      sum += yen;
      lines.push({ name: itemName, yen });
    } else {
      missing.push(itemName);
    }
  }

  lines.sort((a,b)=> b.yen - a.yen);
  return { sum, lines, missing };
}

/* =======================
   ä»£æ›¿é¸æŠãƒãƒ³ãƒ‰ãƒ©ï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«ï¼‰
======================= */
window.handleAltChoiceChange = function(altItem, idx){
  altChoice[altItem] = idx;
  renderResults();
};

/* =======================
   ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
======================= */
function renderCategorySeg(){
  if (!categorySeg) return;
  categorySeg.innerHTML = "";
  for (const cat of CATEGORIES) {
    const b = document.createElement("button");
    b.textContent = cat;
    b.className = (cat === currentCategory) ? "active" : "";
    b.addEventListener("click", () => {
      currentCategory = cat;
      renderCategorySeg();
      renderItems();
    });
    categorySeg.appendChild(b);
  }
}

function renderItems(){
  if (!itemsEl) return;
  itemsEl.innerHTML = "";

  let list = itemsByCategory(currentCategory).filter(passesFilters);

  list.sort((a,b)=>{
    const aEntered = (counts[a]||0) > 0;
    const bEntered = (counts[b]||0) > 0;
    if (pinEntered?.checked && aEntered !== bEntered) return aEntered ? -1 : 1;

    const aFav = favorites.has(a);
    const bFav = favorites.has(b);
    if (aFav !== bFav) return aFav ? -1 : 1;

    return a.localeCompare(b, "ja");
  });

  if (list.length === 0) {
    itemsEl.innerHTML = `<div class="muted">è©²å½“ã™ã‚‹ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Šã¾ã›ã‚“ï¼ˆæ¤œç´¢æ¡ä»¶/ãƒˆã‚°ãƒ«ã‚’è¦‹ç›´ã—ã¦ã­ï¼‰</div>`;
    renderResults();
    return;
  }

  for (const itemName of list) {
    const row = document.createElement("div");
    row.className = "row";

    const craftTimes = counts[itemName] ?? 0;
    if (craftTimes > 0) row.classList.add("entered");

    const left = document.createElement("div");
    left.className = "name";

    const star = document.createElement("button");
    star.className = "star" + (favorites.has(itemName) ? " on" : "");
    star.innerHTML = favorites.has(itemName) ? "â˜…" : "â˜†";
    star.title = "ãŠæ°—ã«å…¥ã‚Š";
    star.addEventListener("click", () => {
      if (favorites.has(itemName)) favorites.delete(itemName);
      else favorites.add(itemName);
      renderItems();
    });

    const y = getYield(itemName);
    const produced = craftTimes * y;
    const cost = getCost(itemName);

    const info = document.createElement("div");
    info.className = "titleWrap";
    info.innerHTML = `
      <div class="title">${itemName}</div>
      <div class="meta">
        <span class="badge">å‡ºæ¥ä¸ŠãŒã‚Šï¼š${produced}ï¼ˆ${y}å€‹/å›ï¼‰</span>
        <span class="badge">æ–™é‡‘ï¼š${fmtYen(cost)}å††/å›</span>
      </div>
    `;

    left.appendChild(star);

    const imgPath = getImagePath(itemName);
    if (imgPath) {
      const img = document.createElement("img");
      img.className = "icon";
      img.src = imgPath;
      img.alt = itemName;
      img.loading = "lazy";
      img.decoding = "async";
      img.addEventListener("error", () => img.remove());
      left.appendChild(img);
    }

    left.appendChild(info);

    const input = document.createElement("input");
    input.type = "number";
    input.min = "0";
    input.step = "1";
    input.value = craftTimes;

    input.addEventListener("input", () => {
      const v = Math.floor(Number(input.value || 0));
      counts[itemName] = Math.max(0, v);
      renderItems();
    });

    row.appendChild(left);
    row.appendChild(input);
    itemsEl.appendChild(row);
  }

  renderResults();
}


/* =======================
   çŠ¯ç½ªãƒšãƒ¼ã‚¸ç”¨
======================= */
function getCrimeNames(){ return Object.keys(CRIMES); }

function computeCrimeTotals(){
  const totals = {};
  for (const c of selectedCrimes) {
    const times = Math.max(1, Number(c.times || 1) || 1);

    // â˜… ã“ã“ãŒãƒã‚¤ãƒ³ãƒˆï¼šmethodå¯¾å¿œ
    const req = getCrimeReq(c.name, c.method);

    for (const [item, qty] of Object.entries(req)) {
      if (item.startsWith("__NOTE")) continue;
      totals[item] = (totals[item] || 0) + (Number(qty || 0) * times);
    }
  }
  return totals;
}

function computeCrimeRequiredSet(){
  const includeMaterials = !!crimeIncludeMaterials?.checked;
  const totals = computeCrimeTotals();
  const reqSet = new Set(Object.keys(totals));

  if (!includeMaterials) return reqSet;

  const stack = [...reqSet];
  const seen = new Set(stack);

  while (stack.length){
    const item = stack.pop();
    const recipe = RECIPES[item];
    if (!recipe) continue;
    for (const ing of Object.keys(recipe)){
      if (!seen.has(ing)){
        seen.add(ing);
        reqSet.add(ing);
        stack.push(ing);
      }
    }
  }
  return reqSet;
}

function refreshCrimeFilters(){
  crimeRequiredSet = computeCrimeRequiredSet();
}

function renderCrimeSelect(){
  if (!crimeSelect) return;
  const names = getCrimeNames();
  crimeSelect.innerHTML = names
    .map(n => `<option value="${n}">${getCrimeDisplayName(n)}</option>`)
    .join("");
}


function renderCrimePlan(){
  if (!crimePlanEl) return;

  if (!selectedCrimes.length){
    crimePlanEl.innerHTML = "ï¼ˆã¾ã è¿½åŠ ãŒã‚ã‚Šã¾ã›ã‚“ï¼‰";
    return;
  }

  const totals = computeCrimeTotals();

  // NOTEå–å¾—ï¼ˆè¤‡æ•°NOTEå¯¾å¿œï¼‰
  const notes = selectedCrimes.flatMap(c => {
  const crime = CRIMES[c.name] || {};
  return Object.entries(crime)
    .filter(([k,v]) => k.startsWith("__NOTE") && v)
    .sort(([a],[b]) => a.localeCompare(b, "ja"))
    .map(([k,v]) => String(v));
  });
  
  const lines = Object.entries(totals)
    .filter(([,v]) => (v||0) > 0)
    .sort((a,b)=> (b[1]||0) - (a[1]||0))
    .map(([k,v]) => `<div class="kv"><span>${k}</span><b>${v}</b></div>`)
    .join("");

  const chips = selectedCrimes.map((c, i) => {
    const t = Math.max(1, Number(c.times||1)||1);
    return `
      <span class="badge" style="margin:4px 6px 0 0; display:inline-flex; align-items:center; gap:6px;">
        ${getCrimeDot(c.name)}${getCrimeDisplayName(c.name)} Ã—${t}
        <button class="star" style="width:26px; height:26px; border-radius:10px;"
                title="å‰Šé™¤" onclick="removeCrime(${i})">Ã—</button>
      </span>
    `;
  }).join("");

  crimePlanEl.innerHTML = `
    <div style="margin-bottom:8px;">${chips}</div>
    ${lines ? `
      <div class="muted" style="margin:6px 0 10px;">åˆè¨ˆï¼ˆå¿…è¦é“å…·ï¼‰</div>
    ${lines}
      ` : ""}
    `;
    // NOTEè¡¨ç¤º
    if(notes.length){
      crimePlanEl.innerHTML += `
        <div class="box note-box" style="margin-top:10px;">
          <div class="secTitle">ğŸ“‹ å¿…è¦æ¡ä»¶</div>
          <div class="note-text">
            ${notes.join("<br>")}
          </div>
        </div>
      `;
    }


}

window.removeCrime = function(i){
  selectedCrimes.splice(i, 1);
  refreshCrimeFilters();
  renderCrimePlan();
  renderCrimeItems();
};

function renderCrimeItems(){
  if (!crimeItemsEl) return;
  refreshCrimeFilters();

  const totals = computeCrimeTotals();
  const items = Object.keys(META).filter(name => crimeRequiredSet.has(name));

  items.sort((a,b)=>{
    const ca = META[a]?.category || "";
    const cb = META[b]?.category || "";
    if (ca !== cb) return ca.localeCompare(cb, "ja");
    return a.localeCompare(b, "ja");
  });

  crimeItemsEl.innerHTML = items.map(name => {
    const cat = META[name]?.category || "";
    const qty = (name in totals) ? totals[name] : null;
    const tag = (qty == null && crimeIncludeMaterials?.checked) ? "ï¼ˆç´ æï¼‰" : "";
    return `
      <div class="item">
        <div class="meta">
          <div class="name">${name}</div>
          <div class="muted">${cat}${tag}</div>
        </div>
        <div class="qty">${qty == null ? "-" : qty}</div>
      </div>
    `;
  }).join("") || '<div class="muted">ï¼ˆã“ã®çŠ¯ç½ªã«å¿…è¦ãªã‚¢ã‚¤ãƒ†ãƒ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ï¼‰</div>';
}

function clearCrimePlan(){
  selectedCrimes.length = 0;
  refreshCrimeFilters();
  renderCrimePlan();
  renderCrimeItems();
}

function setPage(mode){
  const isCrime = (mode === "crime");
  currentPage = isCrime ? "crime" : "craft";

  if (craftPage) craftPage.classList.toggle("hidden", isCrime);
  if (crimePage) crimePage.classList.toggle("hidden", !isCrime);

  if (tabCraft) tabCraft.classList.toggle("active", !isCrime);
  if (tabCrime) tabCrime.classList.toggle("active", isCrime);

  if (isCrime){
    if (crimeSingleMode?.checked && crimeSelect?.value){
      selectedCrimes.length = 0;
      selectedCrimes.push({ name: crimeSelect.value, times: Math.max(1, Number(crimeTimes?.value || 1) || 1) });
    }
    renderCrimePlan();
    renderCrimeItems();
  } else {
    renderItems();
  }
}

function renderResults(){
  const { totals: baseTotals, cost: baseCost, costBreakdown: baseBreak } = computeBaseTotalsAndCost();
  const { breakdowns, chosenCostAdd, chosenCostBreakdown, chosenMatsAdd } = buildAltBreakdowns(baseTotals);

  // æœ€çµ‚ç´ æï¼ˆbase + ä»£æ›¿æ¡ç”¨ææ–™ï¼‰
  const totals = { ...baseTotals };
  for (const [k,v] of Object.entries(chosenMatsAdd)) {
    totals[k] = (totals[k] || 0) + v;
  }
  // ALTã‚¢ã‚¤ãƒ†ãƒ è‡ªèº«ã¯ç´ æä¸€è¦§ã‹ã‚‰æ¶ˆã™ï¼ˆä»£æ›¿æ¬„ã§è¦‹ãˆã‚‹ï¼‰
  for (const altItem of Object.keys(ALT_RECIPES)) {
    if (totals[altItem]) delete totals[altItem];
  }

  // ã‚¯ãƒ©ãƒ•ãƒˆæ–™é‡‘åˆè¨ˆ
  const totalCost = baseCost + chosenCostAdd;
  if (totalYenEl) totalYenEl.textContent = `${fmtYen(totalCost)}å††`;

  // ã‚¯ãƒ©ãƒ•ãƒˆæ–™é‡‘å†…è¨³
  const mergedBreak = [...baseBreak, ...chosenCostBreakdown].sort((a,b)=> b.yen - a.yen);
  if (yenBreakdownEl) {
    yenBreakdownEl.innerHTML = mergedBreak.length
      ? mergedBreak.map(x => `ãƒ»${x.name}ï¼š<b>${fmtYen(x.yen)}å††</b>`).join("<br>")
      : "ãƒ»ï¼ˆã¾ã å…¥åŠ›ãŒã‚ã‚Šã¾ã›ã‚“ï¼‰";
  }

  // ã‚¹ãƒ¼ãƒ‘ãƒ¼ï¼ˆææ–™ï¼‰
  const matsShop = calcShopCostFromTotals(totals);
  if (shopMatsTotalEl) shopMatsTotalEl.textContent = `${fmtYen(matsShop.sum)}å††`;
  if (shopMatsBreakdownEl) {
    const s1 = matsShop.lines.length
      ? matsShop.lines.map(x => `ãƒ»${x.name}ï¼š<b>${fmtYen(x.yen)}å††</b>`).join("<br>")
      : "ãƒ»ï¼ˆã‚¹ãƒ¼ãƒ‘ãƒ¼è³¼å…¥å¯¾è±¡ãªã—ï¼‰";
    shopMatsBreakdownEl.innerHTML = s1;
  }

  // ã‚¹ãƒ¼ãƒ‘ãƒ¼ï¼ˆå®Œæˆå“ï¼‰
  const itemsShop = calcShopCostFromEnteredItems();
  if (shopItemsTotalEl) shopItemsTotalEl.textContent = `${fmtYen(itemsShop.sum)}å††`;
  if (shopItemsBreakdownEl) {
    const s2 = itemsShop.lines.length
      ? itemsShop.lines.map(x => `ãƒ»${x.name}ï¼š<b>${fmtYen(x.yen)}å††</b>`).join("<br>")
      : "ãƒ»ï¼ˆã‚¹ãƒ¼ãƒ‘ãƒ¼è³¼å…¥å¯¾è±¡ãªã—ï¼‰";
    shopItemsBreakdownEl.innerHTML = s2;
  }

  // å¿…è¦ç´ æï¼ˆåˆè¨ˆï¼‰
  const entries = Object.entries(totals).sort((a,b)=> b[1]-a[1]);
  if (matsEl) {
    matsEl.innerHTML = entries.length
      ? entries.map(([k,v]) => `<div class="kv"><span>${k}</span><b>${v}</b></div>`).join("")
      : `<div class="muted">ã¾ã å…¥åŠ›ãŒã‚ã‚Šã¾ã›ã‚“</div>`;
  }

  // ä»£æ›¿ãƒ¬ã‚·ãƒ”è¡¨ç¤ºï¼ˆæ‰‹å‹•é¸æŠï¼‰
  if (altDetails && altEl) {
    if (breakdowns.length) {
      altDetails.open = true;
      altEl.innerHTML = breakdowns.map(b => {
        const opts = b.options.map(opt => {
          const mats = Object.entries(opt.mats)
            .map(([k,v]) => `<li>${k}: <b>${v}</b></li>`)
            .join("");

          const checked = (opt.idx === b.chosenIndex) ? "checked" : "";
          return `
            <label class="opt" style="display:block;">
              <div style="display:flex; gap:10px; align-items:flex-start;">
                <input type="radio"
                       name="alt_${b.item}"
                       value="${opt.idx}"
                       ${checked}
                       onchange="handleAltChoiceChange('${b.item}', ${opt.idx})" />
                <div style="flex:1;">
                  <div><b>${opt.name}</b></div>
                  <div class="muted">${opt.yield}å€‹/å› â†’ ${opt.craftTimes}å›ã‚¯ãƒ©ãƒ•ãƒˆï¼ˆå¿…è¦æ•° ${b.need}ï¼‰</div>
                  <ul>${mats}</ul>
                  <div class="muted">ã“ã®é¸æŠã®æ–™é‡‘ï¼š<b>${fmtYen(opt.costYen)}å††</b></div>
                </div>
              </div>
            </label>
          `;
        }).join("");

        return `
          <div class="box">
            <div><b>${b.item}</b>ï¼ˆå¿…è¦æ•°ï¼š${b.need}ï¼‰</div>
            <div class="muted">â€» ãƒ©ã‚¸ã‚ªã§æ¡ç”¨ãƒ¬ã‚·ãƒ”ã‚’é¸ã¹ã¾ã™ï¼ˆåˆè¨ˆã¯é¸æŠã—ãŸæ–¹ã§è¨ˆç®—ï¼‰</div>
            ${opts}
          </div>
        `;
      }).join("");
    } else {
      altDetails.open = false;
      altEl.innerHTML = `<div class="muted">ï¼ˆä»£æ›¿ãƒ¬ã‚·ãƒ”å¯¾è±¡ã®ç´ æãŒã€ä»Šã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“ï¼‰</div>`;
    }
  }

  // å³ä¸Šãƒ¡ãƒ¢
  const enteredCount = Object.values(counts).filter(v => (v||0) > 0).length;
  if (resultNote) resultNote.textContent = enteredCount ? `å…¥åŠ›ä¸­ï¼š${enteredCount}ä»¶` : "";
}

/* =======================
   ã‚¤ãƒ™ãƒ³ãƒˆ
======================= */

// ãƒšãƒ¼ã‚¸åˆ‡æ›¿ï¼ˆã‚¿ãƒ–ï¼‰
if (tabCraft) tabCraft.addEventListener("click", () => setPage("craft"));
if (tabCrime) tabCrime.addEventListener("click", () => setPage("crime"));

// çŠ¯ç½ªãƒšãƒ¼ã‚¸
if (crimeMethod) crimeMethod.addEventListener("change", () => {
  if (crimeSingleMode?.checked){
    selectedCrimes.length = 0;
    selectedCrimes.push({
      name: crimeSelect.value,
      method: crimeMethod.value,
      times: Math.max(1, Number(crimeTimes?.value || 1) || 1)
    });
  }
  renderCrimePlan();
  renderCrimeItems();
});

if (crimeTimes) crimeTimes.addEventListener("input", () => {
  if (crimeSingleMode?.checked){
    const name = crimeSelect?.value;
    const times = Math.max(1, Number(crimeTimes.value || 1) || 1);
    selectedCrimes.length = 0;
    if (name) selectedCrimes.push({ name, times });
  }
  renderCrimePlan();
  renderCrimeItems();
});
if (crimeIncludeMaterials) crimeIncludeMaterials.addEventListener("change", () => {
  renderCrimePlan();
  renderCrimeItems();
});
if (crimeSingleMode) crimeSingleMode.addEventListener("change", () => {
  const name = crimeSelect?.value;
  const times = Math.max(1, Number(crimeTimes?.value || 1) || 1);
  selectedCrimes.length = 0;
  if (name) selectedCrimes.push({ name, times });
  renderCrimePlan();
  renderCrimeItems();
});
if (addCrimeBtn) addCrimeBtn.addEventListener("click", () => {
  const name = crimeSelect?.value;
  if (!name) return;
  const times = Math.max(1, Number(crimeTimes?.value || 1) || 1);
  selectedCrimes.push({ name, times });
  renderCrimePlan();
  renderCrimeItems();
});
if (clearCrimeBtn) clearCrimeBtn.addEventListener("click", () => clearCrimePlan());

if (searchBox) searchBox.addEventListener("input", () => renderItems());
if (showOnlyFav) showOnlyFav.addEventListener("change", () => renderItems());
if (showOnlyEntered) showOnlyEntered.addEventListener("change", () => renderItems());
if (pinEntered) pinEntered.addEventListener("change", () => renderItems());
if (resetBtn) {
  resetBtn.addEventListener("click", () => {
    if (!confirm("å…¥åŠ›ã‚’ã™ã¹ã¦ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ")) return;

    for (const k of Object.keys(counts)) {
      counts[k] = 0;
    }

    renderItems();
  });
}


/* =======================
   åˆæœŸè¡¨ç¤º
======================= */
renderCrimeSelect();
setPage("craft");
renderCategorySeg();
renderItems();
</script>
</body>
</html>